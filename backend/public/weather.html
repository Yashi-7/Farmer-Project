<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>üå¶Ô∏è Live Weather Advisory</title>
  <style>

    /* .cont {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 20px;
  
  flex-wrap: wrap;
  padding: 15px 20px;
  margin: 25px auto;
  border-radius: 15px;
  border: 1px solid #cfd8dc;
  background-color: #fff;
  max-width: 900px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.08);
} */
label {
  font-weight: 600;
  color: #396270;
}
select {
  padding: 8px 10px;
  border-radius: 6px;
  border: 1px solid #90a4ae;
  font-size: 1em;
  cursor: pointer;
  background: #fafafa;
  transition: 0.3s;
}
select:hover {
  border-color: #2e7d32;
}

    #liveWeatherInfo {
  margin: 20px auto;
  background: #ffffff;
  padding: 20px;
  border-radius: 12px;
  box-shadow: 0 3px 10px rgba(0,0,0,0.1);
  max-width: 800px;
  font-size: 1.05em;
  line-height: 1.6;
}
#liveWeatherInfo strong {
  color: #2e7d32;
}

#liveWeatherInfo h4 {
  margin-top: 20px;
  color: #396270;
}
#liveWeatherInfo > div {
  margin-bottom: 12px;
  padding: 12px;
  border-radius: 10px;
  background: #f9f9f9;
  border-left: 4px solid #2e7d32;
}

#liveWeatherInfo > div:hover {
  background: #f1faf5;
  transform: translateY(-2px);
  transition: all 0.2s ease-in-out;
}


    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      background: #f0f8f5;
      color: #333;
    }
    h1 {
      color: #396270;
      text-align: center;
    }
    select {
      margin: 10px 0;
      padding: 6px;
      font-size: 1em;
    }
    #liveWeatherInfo {
      margin-top: 20px;
      background: #fff;
      padding: 15px;
      border-radius: 8px;
      box-shadow: 0 0 5px rgba(0,0,0,0.1);
    }
    hr {
      margin: 20px 0;
    }

    .cont{
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 15px;
      flex-wrap: wrap;
      padding: 10px;
      margin: 35px;
      border-radius: 25px;
      border: 1px solid #ccc;
       box-shadow: 0 2px 8px rgba(0,0,0,0.08);
      background-color: #fffbea;   
    }

  </style>
</head>
<body>
  <h1 id="weatherTitle">üå¶Ô∏è Live Weather Advisory</h1>

  <div class="cont">
  <label for="languageSelect">üåê Language:</label>
  <select id="languageSelect">
    <option value="en">English</option>
    <option value="hi">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</option>
    <option value="ml">‡¥Æ‡¥≤‡¥Ø‡¥æ‡¥≥‡¥Ç</option>
  </select>


  <label for="districtSelect">üèûÔ∏è District:</label>
  <select id="districtSelect">
    <option value="Thiruvananthapuram">Thiruvananthapuram</option>
    <option value="Kollam">Kollam</option>
    <option value="Pathanamthitta">Pathanamthitta</option>
    <option value="Alappuzha">Alappuzha</option>
    <option value="Kottayam">Kottayam</option>
    <option value="Idukki">Idukki</option>
    <option value="Ernakulam">Ernakulam</option>
    <option value="Thrissur">Thrissur</option>
    <option value="Palakkad">Palakkad</option>
    <option value="Malappuram">Malappuram</option>
    <option value="Kozhikode">Kozhikode</option>
    <option value="Wayanad">Wayanad</option>
    <option value="Kannur">Kannur</option>
    <option value="Kasaragod">Kasaragod</option>
  </select>

  

  <label for="cropSelect">üåæ Crop:</label>
  <select id="cropSelect">
    <option value="paddy">Paddy</option>
    <option value="banana">Banana</option>
    <option value="coconut">Coconut</option>
    <option value="pepper">Pepper</option>
    <option value="vegetables">Vegetables</option>
    <option value="arecanut">Arecanut</option>
  </select>
</div>
  <div id="liveWeatherInfo"></div>

  <!-- Weather Advisory Script -->
  <script>
    let LANGUAGE = "en";
    let SELECTED_CROP = "paddy";
   // üåê Translations
const weatherTranslations = {
  en: {
    title: "Live Weather Advisory",
    error: "Error fetching weather.",
    unavailable: "Weather data unavailable.",
    labels: {
      temp: "Temperature",
      wind: "Wind Speed",
      humidity: "Humidity",
      condition: "Condition",
      precipitation: "Rain Chance",
      advisory: "Advisory"
    }
  },
  hi: {
    title: "‡§§‡§æ‡§ú‡§º‡§æ ‡§Æ‡•å‡§∏‡§Æ ‡§∏‡§≤‡§æ‡§π",
    error: "‡§Æ‡•å‡§∏‡§Æ ‡§°‡•á‡§ü‡§æ ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø‡•§",
    unavailable: "‡§Æ‡•å‡§∏‡§Æ ‡§°‡•á‡§ü‡§æ ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡•§",
    labels: {
      temp: "‡§§‡§æ‡§™‡§Æ‡§æ‡§®",
      wind: "‡§™‡§µ‡§® ‡§ó‡§§‡§ø",
      humidity: "‡§®‡§Æ‡•Ä",
      condition: "‡§∏‡•ç‡§•‡§ø‡§§‡§ø",
      precipitation: "‡§µ‡§∞‡•ç‡§∑‡§æ ‡§∏‡§Ç‡§≠‡§æ‡§µ‡§®‡§æ",
      advisory: "‡§∏‡§≤‡§æ‡§π"
    }
  },
  ml: {
    title: "‡¥§‡¥§‡µç‡¥∏‡¥Æ‡¥Ø ‡¥ï‡¥æ‡¥≤‡¥æ‡¥µ‡¥∏‡µç‡¥•‡¥æ ‡¥â‡¥™‡¥¶‡µá‡¥∂‡¥Ç",
    error: "‡¥ï‡¥æ‡¥≤‡¥æ‡¥µ‡¥∏‡µç‡¥•‡¥æ ‡¥°‡¥æ‡¥±‡µç‡¥± ‡¥≤‡¥≠‡µç‡¥Ø‡¥Æ‡¥æ‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡¥§‡¥ø‡µΩ ‡¥™‡¥ø‡¥∂‡¥ï‡µç.",
    unavailable: "‡¥ï‡¥æ‡¥≤‡¥æ‡¥µ‡¥∏‡µç‡¥•‡¥æ ‡¥°‡¥æ‡¥±‡µç‡¥± ‡¥≤‡¥≠‡µç‡¥Ø‡¥Æ‡¥≤‡µç‡¥≤.",
    labels: {
      temp: "‡¥§‡¥æ‡¥™‡¥®‡¥ø‡¥≤",
      wind: "‡¥ï‡¥æ‡¥±‡µç‡¥±‡¥ø‡¥®‡µç‡¥±‡µÜ ‡¥µ‡µá‡¥ó‡¥§",
      humidity: "‡¥Ü‡µº‡¥¶‡µç‡¥∞‡¥§",
      condition: "‡¥ï‡¥æ‡¥≤‡¥æ‡¥µ‡¥∏‡µç‡¥•",
      precipitation: "‡¥Æ‡¥¥‡¥Ø‡µÅ‡¥ü‡µÜ ‡¥∏‡¥æ‡¥ß‡µç‡¥Ø‡¥§",
      advisory: "‡¥â‡¥™‡¥¶‡µá‡¥∂‡¥Ç"
    }
  }
};

const advisoryTranslations = {
  en: {
    transplanting: "‚úÖ Good for transplanting and irrigation.",
    avoidTransplanting: "‚ö† Heavy rain may damage seedlings. Avoid transplanting.",
    highWind: "üí® High wind. Avoid spraying.",
    fieldPrep: "‚ÑπÔ∏è Monitor soil moisture. Ideal for field prep.",
    waterlogging: "‚ö† Risk of waterlogging. Ensure drainage.",
    suckerPlanting: "‚úÖ Good for sucker planting.",
    interculturalOps: "‚ÑπÔ∏è Stable weather. Proceed with intercultural operations.",
    basinIrrigation: "‚úÖ Ideal for basin irrigation.",
    pestNeutral: "‚ÑπÔ∏è Monitor pest activity. Weather is neutral.",
    mulching: "‚úÖ Good for mulching and nutrient application.",
    leafDamage: "üí® Avoid spraying. Risk of leaf damage.",
    seedRot: "‚ö† Delay sowing. Risk of seed rot.",
    leafySowing: "‚úÖ Favorable for sowing leafy vegetables.",
    nurseryMgmt: "‚ÑπÔ∏è Proceed with nursery management.",
    runoffRisk: "‚ö† Avoid pesticide spraying. Risk of runoff.",
    fertilizer: "‚úÖ Good for fertilizer application.",
    crownRot: "‚ÑπÔ∏è Monitor crown rot. Weather is manageable.",
    stable: "‚ÑπÔ∏è Weather stable. Proceed with regular activities."
  },
  hi: {
    transplanting: "‚úÖ ‡§∞‡•ã‡§™‡§æ‡§à ‡§î‡§∞ ‡§∏‡§ø‡§Ç‡§ö‡§æ‡§à ‡§ï‡•á ‡§≤‡§ø‡§è ‡§â‡§™‡§Ø‡•Å‡§ï‡•ç‡§§‡•§",
    avoidTransplanting: "‚ö† ‡§≠‡§æ‡§∞‡•Ä ‡§µ‡§∞‡•ç‡§∑‡§æ ‡§∏‡•á ‡§™‡•å‡§ß‡•ã‡§Ç ‡§ï‡•ã ‡§®‡•Å‡§ï‡§∏‡§æ‡§® ‡§π‡•ã ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§ ‡§∞‡•ã‡§™‡§æ‡§à ‡§∏‡•á ‡§¨‡§ö‡•á‡§Ç‡•§",
    highWind: "üí® ‡§§‡•á‡§ú‡§º ‡§π‡§µ‡§æ‡•§ ‡§õ‡§ø‡§°‡§º‡§ï‡§æ‡§µ ‡§∏‡•á ‡§¨‡§ö‡•á‡§Ç‡•§",
    fieldPrep: "‚ÑπÔ∏è ‡§Æ‡§ø‡§ü‡•ç‡§ü‡•Ä ‡§ï‡•Ä ‡§®‡§Æ‡•Ä ‡§ï‡•Ä ‡§®‡§ø‡§ó‡§∞‡§æ‡§®‡•Ä ‡§ï‡§∞‡•á‡§Ç‡•§ ‡§ñ‡•á‡§§ ‡§§‡•à‡§Ø‡§æ‡§∞‡•Ä ‡§ï‡•á ‡§≤‡§ø‡§è ‡§â‡§™‡§Ø‡•Å‡§ï‡•ç‡§§‡•§",
    waterlogging: "‚ö† ‡§ú‡§≤‡§≠‡§∞‡§æ‡§µ ‡§ï‡§æ ‡§ñ‡§§‡§∞‡§æ‡•§ ‡§ú‡§≤ ‡§®‡§ø‡§ï‡§æ‡§∏‡•Ä ‡§∏‡•Å‡§®‡§ø‡§∂‡•ç‡§ö‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç‡•§",
    suckerPlanting: "‚úÖ ‡§∏‡§ï‡§∞ ‡§≤‡§ó‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§â‡§™‡§Ø‡•Å‡§ï‡•ç‡§§‡•§",
    interculturalOps: "‚ÑπÔ∏è ‡§Æ‡•å‡§∏‡§Æ ‡§∏‡•ç‡§•‡§ø‡§∞ ‡§π‡•à‡•§ ‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§ï‡§æ‡§∞‡•ç‡§Ø ‡§ú‡§æ‡§∞‡•Ä ‡§∞‡§ñ‡•á‡§Ç‡•§",
    basinIrrigation: "‚úÖ ‡§¨‡•á‡§∏‡§ø‡§® ‡§∏‡§ø‡§Ç‡§ö‡§æ‡§à ‡§ï‡•á ‡§≤‡§ø‡§è ‡§â‡§™‡§Ø‡•Å‡§ï‡•ç‡§§‡•§",
    pestNeutral: "‚ÑπÔ∏è ‡§ï‡•Ä‡§ü ‡§ó‡§§‡§ø‡§µ‡§ø‡§ß‡§ø ‡§ï‡•Ä ‡§®‡§ø‡§ó‡§∞‡§æ‡§®‡•Ä ‡§ï‡§∞‡•á‡§Ç‡•§ ‡§Æ‡•å‡§∏‡§Æ ‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§π‡•à‡•§",
    mulching: "‚úÖ ‡§Æ‡§≤‡•ç‡§ö‡§ø‡§Ç‡§ó ‡§î‡§∞ ‡§™‡•ã‡§∑‡§ï ‡§§‡§§‡•ç‡§µ ‡§¶‡•á‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§â‡§™‡§Ø‡•Å‡§ï‡•ç‡§§‡•§",
    leafDamage: "üí® ‡§õ‡§ø‡§°‡§º‡§ï‡§æ‡§µ ‡§∏‡•á ‡§¨‡§ö‡•á‡§Ç‡•§ ‡§™‡§§‡•ç‡§§‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡•ã ‡§®‡•Å‡§ï‡§∏‡§æ‡§® ‡§π‡•ã ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§",
    seedRot: "‚ö† ‡§¨‡•Å‡§µ‡§æ‡§à ‡§ü‡§æ‡§≤‡•á‡§Ç‡•§ ‡§¨‡•Ä‡§ú ‡§∏‡§°‡§º‡§®‡•á ‡§ï‡§æ ‡§ñ‡§§‡§∞‡§æ‡•§",
    leafySowing: "‚úÖ ‡§™‡§§‡•ç‡§§‡•á‡§¶‡§æ‡§∞ ‡§∏‡§¨‡•ç‡§ú‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡•Ä ‡§¨‡•Å‡§µ‡§æ‡§à ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ö‡§®‡•Å‡§ï‡•Ç‡§≤‡•§",
    nurseryMgmt: "‚ÑπÔ∏è ‡§®‡§∞‡•ç‡§∏‡§∞‡•Ä ‡§™‡•ç‡§∞‡§¨‡§Ç‡§ß‡§® ‡§ú‡§æ‡§∞‡•Ä ‡§∞‡§ñ‡•á‡§Ç‡•§",
    runoffRisk: "‚ö† ‡§õ‡§ø‡§°‡§º‡§ï‡§æ‡§µ ‡§∏‡•á ‡§¨‡§ö‡•á‡§Ç‡•§ ‡§¨‡§π‡§æ‡§µ ‡§ï‡§æ ‡§ñ‡§§‡§∞‡§æ‡•§",
    fertilizer: "‚úÖ ‡§â‡§∞‡•ç‡§µ‡§∞‡§ï ‡§¶‡•á‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§â‡§™‡§Ø‡•Å‡§ï‡•ç‡§§‡•§",
    crownRot: "‚ÑπÔ∏è ‡§ï‡•ç‡§∞‡§æ‡§â‡§® ‡§∞‡•â‡§ü ‡§ï‡•Ä ‡§®‡§ø‡§ó‡§∞‡§æ‡§®‡•Ä ‡§ï‡§∞‡•á‡§Ç‡•§ ‡§Æ‡•å‡§∏‡§Æ ‡§Ö‡§®‡•Å‡§ï‡•Ç‡§≤ ‡§π‡•à‡•§",
    stable: "‚ÑπÔ∏è ‡§Æ‡•å‡§∏‡§Æ ‡§∏‡•ç‡§•‡§ø‡§∞ ‡§π‡•à‡•§ ‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§ï‡§æ‡§∞‡•ç‡§Ø ‡§ï‡§∞‡•á‡§Ç‡•§"
  },
  ml: {
    transplanting: "‚úÖ ‡¥®‡¥ü‡µç‡¥ü‡µç ‡¥®‡¥ø‡µΩ‡¥ï‡µç‡¥ï‡¥æ‡¥®‡µÅ‡¥Ç ‡¥ú‡¥≤‡¥∏‡µá‡¥ö‡¥®‡¥§‡µç‡¥§‡¥ø‡¥®‡µÅ‡¥Ç ‡¥Ö‡¥®‡µÅ‡¥Ø‡µã‡¥ú‡µç‡¥Ø‡¥Ç.",
    avoidTransplanting: "‚ö† ‡¥∂‡¥ï‡µç‡¥§‡¥Æ‡¥æ‡¥Ø ‡¥Æ‡¥¥ ‡¥ö‡µÜ‡¥ü‡¥ø‡¥ï‡µæ‡¥ï‡µç‡¥ï‡µç ‡¥π‡¥æ‡¥®‡¥ø‡¥ï‡¥∞‡¥Æ‡¥æ‡¥£‡µç. ‡¥®‡¥ü‡µç‡¥ü‡µç ‡¥®‡¥ø‡µΩ‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡¥§‡µç ‡¥í‡¥¥‡¥ø‡¥µ‡¥æ‡¥ï‡µç‡¥ï‡µÅ‡¥ï.",
    highWind: "üí® ‡¥∂‡¥ï‡µç‡¥§‡¥Æ‡¥æ‡¥Ø ‡¥ï‡¥æ‡¥±‡µç‡¥±‡µç. ‡¥∏‡µç‡¥™‡µç‡¥∞‡µá ‡¥ö‡µÜ‡¥Ø‡µç‡¥Ø‡µÅ‡¥®‡µç‡¥®‡¥§‡µç ‡¥í‡¥¥‡¥ø‡¥µ‡¥æ‡¥ï‡µç‡¥ï‡µÅ‡¥ï.",
    fieldPrep: "‚ÑπÔ∏è ‡¥Æ‡¥£‡µç‡¥£‡¥ø‡¥≤‡µÜ ‡¥à‡µº‡¥™‡µç‡¥™‡¥Ç ‡¥®‡¥ø‡¥∞‡µÄ‡¥ï‡µç‡¥∑‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥ï. ‡¥µ‡¥Ø‡µΩ ‡¥§‡¥Ø‡µç‡¥Ø‡¥æ‡¥±‡¥æ‡¥ï‡µç‡¥ï‡¥æ‡µª ‡¥Ö‡¥®‡µÅ‡¥Ø‡µã‡¥ú‡µç‡¥Ø‡¥Ç.",
    waterlogging: "‚ö† ‡¥µ‡µÜ‡¥≥‡µç‡¥≥‡¥Ç ‡¥ï‡µÜ‡¥ü‡µç‡¥ü‡¥ø ‡¥®‡¥ø‡µΩ‡¥ï‡µç‡¥ï‡¥æ‡¥®‡µÅ‡¥≥‡µç‡¥≥ ‡¥∏‡¥æ‡¥ß‡µç‡¥Ø‡¥§. ‡¥°‡µç‡¥∞‡µÜ‡¥Ø‡¥ø‡¥®‡µá‡¥ú‡µç ‡¥â‡¥±‡¥™‡µç‡¥™‡¥æ‡¥ï‡µç‡¥ï‡µÅ‡¥ï.",
    suckerPlanting: "‚úÖ ‡¥∏‡¥ï‡µç‡¥ï‡µº ‡¥®‡¥ü‡µç‡¥ü‡µÅ‡¥µ‡¥Ø‡µç‡¥ï‡µç‡¥ï‡¥æ‡µª ‡¥Ö‡¥®‡µÅ‡¥Ø‡µã‡¥ú‡µç‡¥Ø‡¥Ç.",
    interculturalOps: "‚ÑπÔ∏è ‡¥ï‡¥æ‡¥≤‡¥æ‡¥µ‡¥∏‡µç‡¥• ‡¥∏‡µç‡¥•‡¥ø‡¥∞‡¥Æ‡¥æ‡¥£‡µç. ‡¥∏‡¥æ‡¥ß‡¥æ‡¥∞‡¥£ ‡¥™‡µç‡¥∞‡¥µ‡µº‡¥§‡µç‡¥§‡¥®‡¥ô‡µç‡¥ô‡µæ ‡¥§‡µÅ‡¥ü‡¥∞‡µÅ‡¥ï.",
    basinIrrigation: "‚úÖ ‡¥¨‡µá‡¥∏‡¥ø‡µª ‡¥ú‡¥≤‡¥∏‡µá‡¥ö‡¥®‡¥§‡µç‡¥§‡¥ø‡¥®‡µÅ‡¥Ç ‡¥Ö‡¥®‡µÅ‡¥Ø‡µã‡¥ú‡µç‡¥Ø‡¥Ç.",
    pestNeutral: "‚ÑπÔ∏è ‡¥ï‡µÄ‡¥ü ‡¥™‡µç‡¥∞‡¥µ‡µº‡¥§‡µç‡¥§‡¥®‡¥Ç ‡¥®‡¥ø‡¥∞‡µÄ‡¥ï‡µç‡¥∑‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥ï. ‡¥ï‡¥æ‡¥≤‡¥æ‡¥µ‡¥∏‡µç‡¥• ‡¥∏‡¥æ‡¥ß‡¥æ‡¥∞‡¥£‡¥Æ‡¥æ‡¥£‡µç.",
    mulching: "‚úÖ ‡¥Æ‡µæ‡¥ö‡µç‡¥ö‡¥ø‡¥Ç‡¥ó‡¥ø‡¥®‡µÅ‡¥Ç ‡¥™‡µã‡¥∑‡¥ï‡¥ô‡µç‡¥ô‡µæ ‡¥®‡µΩ‡¥ï‡µÅ‡¥®‡µç‡¥®‡¥§‡¥ø‡¥®‡µÅ‡¥Ç ‡¥Ö‡¥®‡µÅ‡¥Ø‡µã‡¥ú‡µç‡¥Ø‡¥Ç.",
    leafDamage: "üí® ‡¥∏‡µç‡¥™‡µç‡¥∞‡µá ‡¥í‡¥¥‡¥ø‡¥µ‡¥æ‡¥ï‡µç‡¥ï‡µÅ‡¥ï. ‡¥á‡¥≤‡¥ï‡µæ‡¥ï‡µç‡¥ï‡µç ‡¥π‡¥æ‡¥®‡¥ø‡¥ï‡¥∞‡¥Æ‡¥æ‡¥£‡µç.",
    seedRot: "‚ö† ‡¥µ‡¥ø‡¥§‡¥ö‡µç‡¥ö ‡¥µ‡¥ø‡¥§‡µç‡¥§‡µÅ‡¥ï‡µæ ‡¥ï‡µÅ‡¥¥‡¥Ø‡¥æ‡¥®‡µÅ‡¥≥‡µç‡¥≥ ‡¥∏‡¥æ‡¥ß‡µç‡¥Ø‡¥§. ‡¥µ‡¥ø‡¥§‡¥Ø‡µç‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡¥§‡µç ‡¥í‡¥¥‡¥ø‡¥µ‡¥æ‡¥ï‡µç‡¥ï‡µÅ‡¥ï.",
    leafySowing: "‚úÖ ‡¥á‡¥≤‡¥ï‡µç‡¥ï‡¥±‡¥ø‡¥ï‡µæ ‡¥µ‡¥ø‡¥§‡¥Ø‡µç‡¥ï‡µç‡¥ï‡¥æ‡µª ‡¥Ö‡¥®‡µÅ‡¥Ø‡µã‡¥ú‡µç‡¥Ø‡¥Ç.",
    nurseryMgmt: "‚ÑπÔ∏è ‡¥®‡¥¥‡µç‚Äå‡¥∏‡¥±‡¥ø ‡¥Æ‡¥æ‡¥®‡µá‡¥ú‡µç‡¥Æ‡µÜ‡¥®‡µç‡¥±‡µç ‡¥§‡µÅ‡¥ü‡¥∞‡µÅ‡¥ï.",
    runoffRisk: "‚ö† ‡¥∏‡µç‡¥™‡µç‡¥∞‡µá ‡¥í‡¥¥‡¥ø‡¥µ‡¥æ‡¥ï‡µç‡¥ï‡µÅ‡¥ï. ‡¥í‡¥¥‡µÅ‡¥ï‡¥ø ‡¥™‡µã‡¥ï‡¥æ‡¥®‡µÅ‡¥≥‡µç‡¥≥ ‡¥∏‡¥æ‡¥ß‡µç‡¥Ø‡¥§.",
    fertilizer: "‚úÖ ‡¥µ‡¥≥‡¥Ç ‡¥®‡µΩ‡¥ï‡¥æ‡µª ‡¥Ö‡¥®‡µÅ‡¥Ø‡µã‡¥ú‡µç‡¥Ø‡¥Ç.",
    crownRot: "‚ÑπÔ∏è ‡¥ï‡µç‡¥∞‡µó‡µ∫ ‡¥±‡µã‡¥ü‡µç‡¥ü‡¥ø‡¥®‡µç‡¥±‡µÜ ‡¥®‡¥ø‡¥∞‡µÄ‡¥ï‡µç‡¥∑‡¥£‡¥Ç ‡¥®‡¥ü‡¥§‡µç‡¥§‡µÅ‡¥ï. ‡¥ï‡¥æ‡¥≤‡¥æ‡¥µ‡¥∏‡µç‡¥• ‡¥Ö‡¥®‡µÅ‡¥Ø‡µã‡¥ú‡µç‡¥Ø‡¥Æ‡¥æ‡¥£‡µç.",
    stable: "‚ÑπÔ∏è ‡¥ï‡¥æ‡¥≤‡¥æ‡¥µ‡¥∏‡µç‡¥• ‡¥∏‡µç‡¥•‡¥ø‡¥∞‡¥Æ‡¥æ‡¥£‡µç. ‡¥∏‡¥æ‡¥ß‡¥æ‡¥∞‡¥£ ‡¥™‡µç‡¥∞‡¥µ‡µº‡¥§‡µç‡¥§‡¥®‡¥ô‡µç‡¥ô‡µæ ‡¥§‡µÅ‡¥ü‡¥∞‡µÅ‡¥ï."
  }
};

const districtCoordinates = {
  Thiruvananthapuram: { lat: 8.5241, lon: 76.9366 },
  Kollam: { lat: 8.8811, lon: 76.5846 },
  Pathanamthitta: { lat: 9.2647, lon: 76.7870 },
  Alappuzha: { lat: 9.4981, lon: 76.3388 },
  Kottayam: { lat: 9.5916, lon: 76.5222 },
  Idukki: { lat: 9.8490, lon: 77.1150 },
  Ernakulam: { lat: 10.0850, lon: 76.5843 },
  Thrissur: { lat: 10.5276, lon: 76.2144 },
  Palakkad: { lat: 10.7867, lon: 76.6548 },
  Malappuram: { lat: 11.0734, lon: 76.0711 },
  Kozhikode: { lat: 11.2588, lon: 75.7804 },
  Wayanad: { lat: 11.7154, lon: 76.1320 },
  Kannur: { lat: 11.8745, lon: 75.3704 },
  Kasaragod: { lat: 12.5000, lon: 75.0000 }
};

function updateHeaders() {
  const titleEl = document.getElementById("weatherTitle");
  if (titleEl) titleEl.innerText = "Live Weather Advisory";
}

function updateWeatherLabels() {
  const t = weatherTranslations[LANGUAGE];
  const titleEl = document.getElementById("weatherTitle");
  if (titleEl) titleEl.innerText = t.title;
}

function getCropAdvisory(crop, rain, humidity, maxTemp, wind) {
  const a = advisoryTranslations[LANGUAGE];
  switch (crop.toLowerCase()) {
    case "paddy":
      if (rain >= 70) return a.avoidTransplanting;
      if (rain >= 40 && humidity >= 80) return a.transplanting;
      if (wind >= 25) return a.highWind;
      return a.fieldPrep;
    case "banana":
      if (rain >= 60) return a.waterlogging;
      if (humidity >= 85 && maxTemp <= 35) return a.suckerPlanting;
      return a.intercultural ;     return a.interculturalOps;

    case "coconut":
      if (rain >= 70) return a.runoffRisk;
      if (humidity >= 75 && wind < 20) return a.basinIrrigation;
      return a.pestNeutral;

    case "pepper":
      if (rain >= 50 && humidity >= 80) return a.mulching;
      if (wind >= 30) return a.leafDamage;
      return a.pestNeutral;

    case "vegetables":
      if (rain >= 60) return a.seedRot;
      if (humidity >= 80 && maxTemp <= 32) return a.leafySowing;
      return a.nurseryMgmt;

    case "arecanut":
      if (rain >= 70) return a.runoffRisk;
      if (humidity >= 75 && wind < 20) return a.fertilizer;
      return a.crownRot;

    default:
      return a.stable;
  }
}
function updateHeaders() {
  const titleEl = document.getElementById("weatherTitle");
  if (titleEl) titleEl.innerText = "Live Weather Advisory";
}

function updateWeatherLabels() {
  const t = weatherTranslations[LANGUAGE];
  const titleEl = document.getElementById("weatherTitle");
  if (titleEl) titleEl.innerText = t.title;
}
const weatherCodesLocalized = {
  0: { en: "Clear sky ‚òÄ", hi: "‡§∏‡§æ‡§´‡§º ‡§Ü‡§ï‡§æ‡§∂ ‚òÄ", ml: "‡¥∏‡µç‡¥µ‡¥ö‡µç‡¥õ‡¥Æ‡¥æ‡¥Ø ‡¥Ü‡¥ï‡¥æ‡¥∂‡¥Ç ‚òÄ" },
  1: { en: "Mainly clear üå§", hi: "‡§Æ‡•Å‡§ñ‡•ç‡§Ø‡§§‡§É ‡§∏‡§æ‡§´‡§º üå§", ml: "‡¥Ö‡¥ß‡¥ø‡¥ï‡¥Ç ‡¥∏‡µç‡¥µ‡¥ö‡µç‡¥õ‡¥Ç üå§" },
  2: { en: "Partly cloudy ‚õÖ", hi: "‡§Ü‡§Ç‡§∂‡§ø‡§ï ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§¨‡§æ‡§¶‡§≤ ‚õÖ", ml: "‡¥≠‡¥æ‡¥ó‡¥ø‡¥ï‡¥Æ‡¥æ‡¥Ø‡¥ø ‡¥Æ‡µá‡¥ò‡¥æ‡¥µ‡µÉ‡¥§‡¥Ç ‚õÖ" },
  3: { en: "Overcast ‚òÅ", hi: "‡§™‡•Ç‡§∞‡§æ ‡§¨‡§æ‡§¶‡§≤ ‚òÅ", ml: "‡¥Æ‡µÅ‡¥¥‡µÅ‡¥µ‡µª ‡¥Æ‡µá‡¥ò‡¥æ‡¥µ‡µÉ‡¥§‡¥Ç ‚òÅ" },
  45: { en: "Fog üå´", hi: "‡§ï‡•ã‡§π‡§∞‡§æ üå´", ml: "‡¥Æ‡µÇ‡¥ü‡µΩ‡¥Æ‡¥û‡µç‡¥û‡µç üå´" },
  61: { en: "Light rain üåß", hi: "‡§π‡§≤‡•ç‡§ï‡•Ä ‡§¨‡§æ‡§∞‡§ø‡§∂ üåß", ml: "‡¥á‡¥≥‡¥ø‡¥Ø ‡¥Æ‡¥¥ üåß" },
  80: { en: "Rain showers üå¶", hi: "‡§¨‡§æ‡§∞‡§ø‡§∂ ‡§ï‡•Ä ‡§¨‡•å‡§õ‡§æ‡§∞‡•á‡§Ç üå¶", ml: "‡¥Æ‡¥¥‡¥Ø‡µÅ‡¥ü‡µÜ ‡¥§‡µÅ‡¥≥‡µç‡¥≥‡¥ø‡¥ï‡µæ üå¶" }
};
// üå¶Ô∏è Fetch weather manually by district
async function fetchLiveWeather(district = "Thiruvananthapuram", crop = "paddy") {
  const coords = districtCoordinates[district];
  const t = weatherTranslations[LANGUAGE];
  const infoBox = document.getElementById("liveWeatherInfo");

  if (!infoBox || !coords) {
    infoBox.innerText = t.unavailable;
    return;
  }

  const url = `https://api.open-meteo.com/v1/forecast?latitude=${coords.lat}&longitude=${coords.lon}&current_weather=true&daily=temperature_2m_max,temperature_2m_min,weathercode,windspeed_10m_max,precipitation_probability_max&hourly=relative_humidity_2m,precipitation_probability&timezone=auto`;

  try {
    const res = await fetch(url);
    const data = await res.json();

    if (data && data.current_weather) {
      const temp = data.current_weather.temperature;
      const wind = data.current_weather.windspeed;
      const code = data.current_weather.weathercode;
      const condition = weatherCodesLocalized[code]?.[LANGUAGE] || "Unknown";

      let humidity = "‚Äî", rainChance = "‚Äî";
      const nowHour = new Date().toISOString().slice(0, 13);
      const index = data.hourly.time.findIndex(t => t.startsWith(nowHour));
      if (index !== -1) {
        humidity = data.hourly.relative_humidity_2m?.[index] + "%" || "‚Äî";
        rainChance = data.hourly.precipitation_probability?.[index] + "%" || "‚Äî";
      }

      const advisory = getCropAdvisory(crop, parseInt(rainChance), parseInt(humidity), temp, wind);

      infoBox.innerHTML = `
        <strong>${t.labels.temp}:</strong> ${temp}¬∞C<br>
        <strong>${t.labels.wind}:</strong> ${wind} km/h<br>
        <strong>${t.labels.humidity}:</strong> ${humidity}<br>
        <strong>${t.labels.precipitation}:</strong> ${rainChance}<br>
        <strong>${t.labels.condition}:</strong> ${condition}<br>
        <strong>${t.labels.advisory}:</strong> ${advisory}
      `;
    } else {
      infoBox.innerText = t.unavailable;
    }

    // üìÖ 3-Day Forecast
    if (data && data.daily) {
      const daily = data.daily;
      let forecastHTML = `<hr><h4>üìÖ 3-Day Forecast</h4>`;

      for (let i = 0; i < 3; i++) {
        const dateObj = new Date(daily.time[i]);
        const date = dateObj.toLocaleDateString();
        const day = dateObj.toLocaleDateString(undefined, { weekday: 'long' });

        const min = daily.temperature_2m_min[i];
        const max = daily.temperature_2m_max[i];
        const wind = daily.windspeed_10m_max?.[i] ?? "‚Äî";
        const rain = daily.precipitation_probability_max?.[i] ?? "‚Äî";
        const code = daily.weathercode[i];
        const condition = weatherCodesLocalized[code]?.[LANGUAGE] || "Unknown";

        let humidity = "‚Äî";
        const targetHour = daily.time[i] + "T08:00";
        const index = data.hourly.time.findIndex(t => t === targetHour);
        if (index !== -1) {
          humidity = data.hourly.relative_humidity_2m[index] + "%";
        }

        const advisory = getCropAdvisory(crop, parseInt(rain), parseInt(humidity), max, wind);

        forecastHTML += `
          <div style="margin-bottom: 12px; padding: 8px; border-left: 3px solid #007BFF;">
            <strong>${day}, ${date}</strong><br>
            üå° ${t.labels.temp}: ${min}¬∞C ‚Äì ${max}¬∞C<br>
            üíß ${t.labels.humidity}: ${humidity}<br>
            üå¨ ${t.labels.wind}: ${wind} km/h<br>
            ‚òî ${t.labels.precipitation}: ${rain}%<br>
            üå• ${t.labels.condition}: ${condition}<br>
            üåæ ${t.labels.advisory}: ${advisory}
          </div>
        `;
      }

      infoBox.innerHTML += forecastHTML;
    }
  } catch (err) {
    console.error("Weather fetch failed:", err);
    infoBox.innerText = t.error;
  }
}

document.getElementById("languageSelect").addEventListener("change", (e) => {
  LANGUAGE = e.target.value;
  updateWeatherLabels();
  SELECTED_CROP = document.getElementById("cropSelect").value;
  fetchLiveWeather(document.getElementById("districtSelect").value, SELECTED_CROP);
});

document.getElementById("districtSelect").addEventListener("change", (e) => {
  SELECTED_CROP = document.getElementById("cropSelect").value;
  fetchLiveWeather(e.target.value, SELECTED_CROP);
});

document.getElementById("cropSelect").addEventListener("change", (e) => {
  SELECTED_CROP = e.target.value;
  fetchLiveWeather(document.getElementById("districtSelect").value, SELECTED_CROP);
});

window.onload = function () {
  updateHeaders();
  updateWeatherLabels();
  SELECTED_CROP = document.getElementById("cropSelect").value;
  fetchLiveWeather(document.getElementById("districtSelect").value, SELECTED_CROP);
};
  </script>
</body>
</html>