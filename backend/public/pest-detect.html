<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>๐งช Plant Health Diagnosis</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      background: #F1FAF0;
      color: #333;
    }
    h1 {
      color: #2e7d32;
    }
    #image-preview img, .diagnosis-block img {
      max-width: 300px;
      margin: 10px 0;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
    .diagnosis-block {
      background: #fff;
      padding: 15px;
      margin-top: 20px;
      border-radius: 8px;
      box-shadow: 0 0 5px rgba(0,0,0,0.1);
    }
    #footerText {
      margin-top: 40px;
      font-size: 0.9em;
      color: #666;
      text-align: center;
    }
    select, input[type="file"] {
      margin-top: 10px;
      padding: 5px;
      font-size: 0.95em;
    }
  h1{
    text-align: center;
    margin-top: 50px;
  }
  
  .lang{
    margin-right: 10px;

  }

  
   
  .center-container {
  display: flex;
  padding: 40px;
 box-shadow: 0 2px 8px rgba(0,0,0,0.08);
  margin: 40px;
  flex-direction: column; /* stack elements vertically */
  align-items: center;    /* center horizontally */
  justify-content: flex-start;
  max-width: 800px;
  background-color: #F5F5DC; /* light beige background */
  border: 1px solid #ccc; /* optional border */
  gap: 20px;              /* space between elements */
  margin-top: 30px;       /* optional spacing from top */
  text-align: center;     /* center labels and text */
 margin-left: 300px;
}
 
/* .lang{
  font-weight: bold;
  color: #3e2723;
} */

/* .lab{
  font-weight: bold;
} */

/* Label styling */
.lab, .lang label {
  font-weight: bold;
  color: #3e2723;
  margin-right: 5px;
}

/* label{
  border: 1px solid transparent;
  border-radius: 25px;
} */
  /* .navv{
    display: flex;
    justify-content: center;
    align-items: center;
    margin-top: 20px;
    width: 100%;
    align-items: center;
    border-radius: 20px;
     box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    padding: 15px;
    width: 650px;
    background-color: rgba(46, 125, 50,0.3);
  } */ 


  .navv {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 25px;
  flex-wrap: wrap; /* makes it responsive */
  width: 100%;
  padding: 15px;
  border-radius: 12px;
  background-color: rgba(46, 125, 50, 0.15);
  box-shadow: 0 2px 8px rgba(0,0,0,0.08);
}
  </style>
</head>
<body>

  <h1 id="diagnosisTitle">๐งช PLANT HEALTH DIAGNOSIS</h1>

<div class="center-container">

  <!-- Upload + Language bar -->
  <div class="navv">
    <div class="upload">
      <label id="uploadLabel" for="imageUpload" class="lab">๐ค Upload Image:</label>
      <input type="file" id="imageUpload" accept="image/*" />
    </div>

    <div class="lang">
      <label for="languageSelect">๐ Language:</label>
      <select id="languageSelect">
        <option value="en">English</option>
        <option value="hi">เคนเคฟเคจเฅเคฆเฅ</option>
        <option value="ml">เดฎเดฒเดฏเดพเดณเด</option>
      </select>
    </div>
  </div>

  <!-- Results -->
  <div id="image-info"></div>
  <div id="image-preview"></div>
  <div id="label-container" class="diagnosis-block"></div>

  <!-- Footer -->
  <div id="footerText">
    ๐ฑ Powered by Teachable Machine & Kerala Agricultural Guidelines
  </div>
</div>

  
  <!-- <h1 id="diagnosisTitle">๐งช PLANT HEALTH DIAGNOSIS</h1>
  <div class="center-container">
     <div class="navv">
    <div class="upload">
  <label id="uploadLabel" for="imageUpload" class="lab">๐ค Upload Image:</label>
  <input type="file" id="imageUpload" accept="image/*"  />
   </div>

  <div class="lang"> 
    <label for="languageSelect" >๐ Language:</label>
    <select id="languageSelect">
      <option value="en">English</option>
      <option value="hi">เคนเคฟเคจเฅเคฆเฅ</option>
      <option value="ml">เดฎเดฒเดฏเดพเดณเด</option>
    </select>
  </div>
</div>
  <div id="image-info"></div>
  <div id="image-preview"></div>

  <div id="label-container" class="diagnosis-block"></div>

  <div id="footerText">๐ฑ Powered by Teachable Machine & Kerala Agricultural Guidelines</div>
  </div> -->

  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest/dist/tf.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@latest/dist/teachablemachine-image.min.js"></script>
  <!-- Diagnosis Script -->
  <script>
   let LANGUAGE = "en";
    const MODEL_URL = "https://teachablemachine.withgoogle.com/models/35xEdOuZ8/";
    const CONFIDENCE_THRESHOLD = 0.75;

    let model, labelContainer, maxPredictions;
    let lastPrediction = null;

    const translationsDiagnosis = {
      en: {
        title: "๐งช Plant Health Diagnosis",
        uploadLabel: "๐ค Upload Image:",
        confidence: "Confidence",
        diagnosis: "Diagnosis",
        solution: "Solution",
        noImage: "Please select an image.",
        unclear: "Please try a clearer photo.",
        footer: "๐ฑ Powered by Teachable Machine & Kerala Agricultural Guidelines"


 

      },
      hi: {
        title: "๐งช เคชเฅเคงเฅ เคเคพ เคธเฅเคตเคพเคธเฅเคฅเฅเคฏ เคจเคฟเคฆเคพเคจ",
        uploadLabel: "๐ค เคเคตเคฟ เคเคชเคฒเฅเคก เคเคฐเฅเค:",
        confidence: "เคตเคฟเคถเฅเคตเคพเคธ เคธเฅเคคเคฐ",
        diagnosis: "เคจเคฟเคฆเคพเคจ",
        solution: "เคธเคฎเคพเคงเคพเคจ",
        noImage: "เคเฅเคชเคฏเคพ เคเค เคเคตเคฟ เคเฅเคจเฅเคเฅค",
        unclear: "เคเฅเคชเคฏเคพ เคธเฅเคชเคทเฅเค เคเคตเคฟ เคเคชเคฒเฅเคก เคเคฐเฅเคเฅค",
        footer: "๐ฑ เคเฅเคเฅเคฌเคฒ เคฎเคถเฅเคจ เคเคฐ เคเฅเคฐเคฒ เคเฅเคทเคฟ เคฆเคฟเคถเคพเคจเคฟเคฐเฅเคฆเฅเคถ เคฆเฅเคตเคพเคฐเคพ เคธเคเคเคพเคฒเคฟเคค"

      },
      ml: {
        title: "๐งช เดเตเดเดฟเดฏเตเดเต เดเดฐเตเดเตเดฏเดจเดฟเตผเดฃเตเดฃเดฏเด",
        uploadLabel: "๐ค เดเดฟเดคเตเดฐเด เดเดชเตโเดฒเตเดกเต เดเตเดฏเตเดฏเตเด:",
        confidence: "เดตเดฟเดถเตเดตเดพเดธเด",
        diagnosis: "เดจเดฟเดฐเตเดเตเดทเดฃเด",
        solution: "เดชเดฐเดฟเดนเดพเดฐเด",
        noImage: "เดฆเดฏเดตเดพเดฏเดฟ เดเดฐเต เดเดฟเดคเตเดฐเด เดคเดฟเดฐเดเตเดเตเดเตเดเตเดเตเด.",
        unclear: "เดตเตเดฏเดเตเดคเดฎเดพเดฏ เดเดฟเดคเตเดฐเด เดเดชเตโเดฒเตเดกเต เดเตเดฏเตเดฏเตเด.",
        footer: "๐ฑ เดเตเดเตเดเดฌเดฟเตพ เดฎเตเดทเตเดจเตเด เดเตเดฐเดณ เดเดพเตผเดทเดฟเด เดฎเดพเตผเดเดจเดฟเตผเดฆเตเดฆเตเดถเดเตเดเดณเตเด เดเตเตผเดจเตเดจเต เดชเตเดฐเดตเตผเดคเตเดคเดฟเดเตเดเตเดจเตเดจเต"

      }
    };

    const advisoryMap = {
  "Class 1": {
    label: {
      en: "Yellow Leaf",
      hi: "เคชเฅเคฒเคพ เคชเคคเฅเคคเคพ",
      ml: "เดฎเดเตเด เดเดฒ"
    },
    solution: {
      en: `๐ชด Organic Methods:
- Use compost tea to enrich soil nutrients.
- Apply banana peel water for potassium boost.
- Spray diluted seaweed extract to improve leaf health.
- Ensure proper sunlight and avoid overwatering.

๐งช Non-Organic Methods:
- Use balanced NPK fertilizers (e.g., 20-20-20).
- Apply iron or magnesium supplements if deficiency is suspected.
- Use commercial foliar sprays for quick nutrient absorption.`,

      hi: `๐ชด เคเฅเคตเคฟเค เคตเคฟเคงเคฟเคฏเคพเค:
- เคเคฎเฅเคชเฅเคธเฅเค เคเคพเคฏ เคเคพ เคเคชเคฏเฅเค เคเคฐเฅเค เคคเคพเคเคฟ เคฎเคฟเคเฅเคเฅ เคฎเฅเค เคชเฅเคทเค เคคเคคเฅเคต เคฌเคขเคผเฅเคเฅค
- เคเฅเคฒเฅ เคเฅ เคเคฟเคฒเคเฅ เคเคพ เคชเคพเคจเฅ เคชเฅเคเฅเคถเคฟเคฏเคฎ เคเฅ เคฒเคฟเค เคเคชเคฏเฅเค เคเคฐเฅเคเฅค
- เคธเคฎเฅเคฆเฅเคฐเฅ เคถเฅเคตเคพเคฒ เคเคฐเฅเค เคเคพ เคเคฟเคกเคผเคเคพเคต เคเคฐเฅเคเฅค
- เคชเคฐเฅเคฏเคพเคชเฅเคค เคงเฅเคช เคฆเฅเค เคเคฐ เคเคงเคฟเค เคชเคพเคจเฅ เคธเฅ เคฌเคเฅเคเฅค

๐งช เคฐเคพเคธเคพเคฏเคจเคฟเค เคตเคฟเคงเคฟเคฏเคพเค:
- เคธเคเคคเฅเคฒเคฟเคค เคเคจเคชเฅเคเฅ เคเคฐเฅเคตเคฐเค (เคเฅเคธเฅ 20-20-20) เคเคพ เคชเฅเคฐเคฏเฅเค เคเคฐเฅเคเฅค
- เคฏเคฆเคฟ เคเคฎเฅ เคนเฅ เคคเฅ เคเคฏเคฐเคจ เคฏเคพ เคฎเฅเคเฅเคจเฅเคถเคฟเคฏเคฎ เคธเคชเฅเคฒเฅเคฎเฅเคเค เคฆเฅเคเฅค
- เคคเฅเคตเคฐเคฟเคค เคชเฅเคทเคฃ เคเฅ เคฒเคฟเค เคซเฅเคฒเคฟเคฏเคฐ เคธเฅเคชเฅเคฐเฅ เคเคพ เคเคชเคฏเฅเค เคเคฐเฅเคเฅค`,

      ml: `๐ชด เดเตผเดเดพเดจเดฟเดเต เดฎเดพเตผเดเดเตเดเตพ:
- เดฎเดฃเตเดฃเดฟเดฒเต เดชเตเดทเดเดเตเดเตพ เดตเตผเดฆเตเดงเดฟเดชเตเดชเดฟเดเตเดเดพเตป เดเตเดฎเตเดชเตเดธเตเดฑเตเดฑเต เดเต เดเดชเดฏเตเดเดฟเดเตเดเตเด.
- เดชเตเดเตเดเดพเดธเตเดฏเด เดตเตผเดฆเตเดงเดฟเดชเตเดชเดฟเดเตเดเดพเตป เดตเดพเดดเดชเตเดชเดดเด เดคเตเดฒเดฟ เดตเตเดณเตเดณเด เดเดชเดฏเตเดเดฟเดเตเดเตเด.
- เดเดฒเดฏเตเดเต เดเดฐเตเดเตเดฏเดคเตเดคเดฟเดจเต เดเดเตฝเดเตเดเตเดเดฟ เดเดเตเดธเตเดเตเดฐเดพเดเตเดฑเตเดฑเต เดธเตเดชเตเดฐเต เดเตเดฏเตเดฏเตเด.
- เดฎเดคเดฟเดฏเดพเดฏ เดธเตเดฐเตเดฏเดชเตเดฐเดเดพเดถเด เดจเตฝเดเตเด, เดเดงเดฟเด เดเดฒเดธเตเดเดจเด เดเดดเดฟเดตเดพเดเตเดเตเด.

๐งช เดฐเดพเดธเดฎเดพเตผเดเดเตเดเตพ:
- เดฌเดพเดฒเตปเดธเตเดกเต NPK เดซเตผเดเตเดเดฟเดฒเตเดธเตผ (เดเดฆเดพ: 20-20-20) เดเดชเดฏเตเดเดฟเดเตเดเตเด.
- เดเตเดฑเดตเตเดฃเตเดเตเดเตเดเดฟเตฝ เดเดฐเตเดฎเตเดชเต เดเดฒเตเดฒเตเดเตเดเดฟเตฝ เดฎเดเตเดจเตเดทเตเดฏเด เดธเดชเตเดฒเดฟเดฎเตเดจเตเดฑเตเดเตพ เดจเตฝเดเตเด.
- เดตเตเดเดคเตเดคเดฟเตฝ เดชเตเดทเดเดเตเดเตพ เดฒเดญเดฟเดเตเดเดพเตป เดซเตเดณเดฟเดฏเตผ เดธเตเดชเตเดฐเต เดเดชเดฏเตเดเดฟเดเตเดเตเด.`
    },
    images: [
      "assets/yellow.jpg",
      "assets/WhatsApp Image 2025-09-12 at 00.53.31_ef146f3e.jpg"
  ],imageTitles: {
    en: ["Kerala Affected Region", "Chance of Recovery"],
    hi: ["เคเฅเคฐเคฒ เคชเฅเคฐเคญเคพเคตเคฟเคค เคเฅเคทเฅเคคเฅเคฐ", "เคชเฅเคจเคฐเฅเคชเฅเคฐเคพเคชเฅเคคเคฟ เคเฅ เคธเคเคญเคพเคตเคจเคพ"],
    ml: ["เดเตเดฐเดณเด เดฌเดพเดงเดฟเดเตเด เดชเตเดฐเดฆเตเดถเด", "เดชเตเดจเดฐเดงเดฟเดตเดพเดธ เดธเดพเดงเตเดฏเดค"]
  }


  },

  "Class 2": {
    label: {
      en: "No Disease",
      hi: "เคเฅเค เคฐเฅเค เคจเคนเฅเค",
      ml: "เดฐเตเดเดฎเดฟเดฒเตเดฒ"
    },
    solution: {
      en: `โ Your plant is healthy!
- Continue regular watering and sunlight.
- Use compost or organic mulch to maintain soil health.
- Monitor occasionally for pests or discoloration.`,

      hi: `โ เคเคชเคเคพ เคชเฅเคงเคพ เคธเฅเคตเคธเฅเคฅ เคนเฅ!
- เคจเคฟเคฏเคฎเคฟเคค เคฐเฅเคช เคธเฅ เคชเคพเคจเฅ เคเคฐ เคงเฅเคช เคฆเฅเคจเคพ เคเคพเคฐเฅ เคฐเคเฅเคเฅค
- เคฎเคฟเคเฅเคเฅ เคเฅ เคเฅเคฃเคตเคคเฅเคคเคพ เคฌเคจเคพเค เคฐเคเคจเฅ เคเฅ เคฒเคฟเค เคเคฎเฅเคชเฅเคธเฅเค เคฏเคพ เคเฅเคตเคฟเค เคฎเคฒเฅเค เคเคพ เคเคชเคฏเฅเค เคเคฐเฅเคเฅค
- เคธเคฎเคฏ-เคธเคฎเคฏ เคชเคฐ เคเฅเค เคฏเคพ เคฐเคเค เคชเคฐเคฟเคตเคฐเฅเคคเคจ เคเฅ เคเคพเคเค เคเคฐเฅเคเฅค`,

      ml: `โ เดจเดฟเดเตเดเดณเตเดเต เดเตเดเดฟ เดเดฐเตเดเตเดฏเดตเดพเดจเดพเดฃเต!
- เดชเดคเดฟเดตเดพเดฏเดฟ เดเดฒเดธเตเดเดจเด เดเตเดฏเตเดฏเตเด, เดฎเดคเดฟเดฏเดพเดฏ เดธเตเดฐเตเดฏเดชเตเดฐเดเดพเดถเด เดจเตฝเดเตเด.
- เดฎเดฃเตเดฃเดฟเดจเตเดฑเต เดเดฐเตเดเตเดฏเดคเตเดคเดฟเดจเต เดเตเดฎเตเดชเตเดธเตเดฑเตเดฑเต เดเดฒเตเดฒเตเดเตเดเดฟเตฝ เดเตผเดเดพเดจเดฟเดเต เดฎเตพเดเตเดเต เดเดชเดฏเตเดเดฟเดเตเดเตเด.
- เดเตเดเดเตเดเตพเดเตเดเตเด เดเดฒเดเดณเดฟเดฒเต เดฎเดพเดฑเตเดฑเดเตเดเตพเดเตเดเตเด เดจเดฟเดฐเตเดเตเดทเดฃเด เดคเตเดเดฐเตเด.`
    },
   
      
  
  },

  "Class 3": {
    label: {
      en: "Rust Leaf",
      hi: "เคเคเค เคฒเคเฅ เคชเคคเฅเคคเฅ",
      ml: "เดฑเดธเตเดฑเตเดฑเต เดเดฒ"
    },
    solution: {
      en: `๐ชด Organic Methods:
- Remove affected leaves and dispose of them safely.
- Improve air circulation around the plant to reduce humidity.
- Spray neem oil weekly to suppress fungal growth.
- Use baking soda solution (1 tsp baking soda + 1 liter water) to neutralize spores.
- Apply compost tea or seaweed extract to boost plant immunity.

๐งช Non-Organic Methods:
- Use copper-based fungicides like copper oxychloride or Bordeaux mixture.
- Apply systemic fungicides containing myclobutanil or chlorothalonil (follow label instructions).
- Avoid overhead watering to prevent moisture buildup.
- Use protective gloves and mask while applying chemical treatments.`,

      hi: `๐ชด เคเฅเคตเคฟเค เคตเคฟเคงเคฟเคฏเคพเค:
- เคชเฅเคฐเคญเคพเคตเคฟเคค เคชเคคเฅเคคเฅเค เคเฅ เคนเคเคพเคเคฐ เคธเฅเคฐเคเฅเคทเคฟเคค เคฐเฅเคช เคธเฅ เคจเคทเฅเค เคเคฐเฅเคเฅค
- เคชเฅเคงเฅ เคเฅ เคเคพเคฐเฅเค เคเคฐ เคนเคตเคพ เคเคพ เคชเฅเคฐเคตเคพเคน เคฌเคขเคผเคพเคเค เคคเคพเคเคฟ เคจเคฎเฅ เคเคฎ เคนเฅเฅค
- เคจเฅเคฎ เคคเฅเคฒ เคเคพ เคธเคพเคชเฅเคคเคพเคนเคฟเค เคเคฟเคกเคผเคเคพเคต เคเคฐเฅเคเฅค
- เคฌเฅเคเคฟเคเค เคธเฅเคกเคพ เคเฅเคฒ (1 เคเคฎเฅเคฎเค เคฌเฅเคเคฟเคเค เคธเฅเคกเคพ + 1 เคฒเฅเคเคฐ เคชเคพเคจเฅ) เคเคพ เคเคชเคฏเฅเค เคเคฐเฅเคเฅค
- เคชเฅเคงเฅ เคเฅ เคชเฅเคฐเคคเคฟเคฐเคเฅเคทเคพ เคฌเคขเคผเคพเคจเฅ เคเฅ เคฒเคฟเค เคเคฎเฅเคชเฅเคธเฅเค เคเคพเคฏ เคฏเคพ เคธเคฎเฅเคฆเฅเคฐเฅ เคถเฅเคตเคพเคฒ เคเคฐเฅเค เคเคพ เคชเฅเคฐเคฏเฅเค เคเคฐเฅเคเฅค

๐งช เคฐเคพเคธเคพเคฏเคจเคฟเค เคตเคฟเคงเคฟเคฏเคพเค:
- เคเฅเคชเคฐ เคเคเฅเคธเฅเคเฅเคฒเฅเคฐเคพเคเคก เคฏเคพ เคฌเฅเคฐเฅเคกเฅ เคฎเคฟเคถเฅเคฐเคฃ เคเฅเคธเฅ เคคเคพเคเคฌเฅ-เคเคงเคพเคฐเคฟเคค เคซเคซเฅเคเคฆเคจเคพเคถเคเฅเค เคเคพ เคชเฅเคฐเคฏเฅเค เคเคฐเฅเคเฅค
- เคฎเคพเคเคเฅเคฒเฅเคฌเฅเคฏเฅเคเคพเคจเคฟเคฒ เคฏเคพ เคเฅเคฒเฅเคฐเฅเคฅเคพเคฒเฅเคจเคฟเคฒ เคฏเฅเคเฅเคค เคชเฅเคฐเคฃเคพเคฒเฅเคเคค เคซเคซเฅเคเคฆเคจเคพเคถเคเฅเค เคเคพ เคชเฅเคฐเคฏเฅเค เคเคฐเฅเค (เคจเคฟเคฐเฅเคฆเฅเคถเฅเค เคเคพ เคชเคพเคฒเคจ เคเคฐเฅเค)เฅค
- เคจเคฎเฅ เคธเฅ เคฌเคเคจเฅ เคเฅ เคฒเคฟเค เคเคชเคฐ เคธเฅ เคชเคพเคจเฅ เคฆเฅเคจเฅ เคธเฅ เคฌเคเฅเคเฅค
- เคฐเคพเคธเคพเคฏเคจเคฟเค เคเคชเคเคพเคฐ เคเคฐเคคเฅ เคธเคฎเคฏ เคฆเคธเฅเคคเคพเคจเฅ เคเคฐ เคฎเคพเคธเฅเค เคชเคนเคจเฅเคเฅค`,

      ml: `๐ชด เดเตผเดเดพเดจเดฟเดเต เดฎเดพเตผเดเดเตเดเตพ:
- เดฌเดพเดงเดฟเดเตเด เดเดฒเดเตพ เดจเตเดเตเดเดเดเตเดฏเตเดคเต เดธเตเดฐเดเตเดทเดฟเดคเดฎเดพเดฏเดฟ เดจเดถเดฟเดชเตเดชเดฟเดเตเดเตเด.
- เดเตเดเดฟเดฏเตเดเต เดเตเดฑเตเดฑเตเด เดตเดพเดฏเต เดชเตเดฐเดตเดพเดนเด เดฎเตเดเตเดเดชเตเดชเตเดเตเดคเตเดคเตเด.
- เดจเตเด เดเดฏเดฟเตฝ เดเดดเตเดเดคเตเดฑเตเด เดธเตเดชเตเดฐเต เดเตเดฏเตเดฏเตเด.
- เดฌเตเดเตเดเดฟเดเดเต เดธเตเดกเดพ เดฆเตเดฐเดพเดตเดเด (1 เดเตเดธเตเดชเตเตบ + 1 เดฒเดฟเดฑเตเดฑเตผ เดตเตเดณเตเดณเด) เดเดชเดฏเตเดเดฟเดเตเดเตเด.
- เดเตเดเดฟเดฏเตเดเต เดชเตเดฐเดคเดฟเดฐเตเดงเดถเตเดทเดฟ เดตเตผเดฆเตเดงเดฟเดชเตเดชเดฟเดเตเดเดพเตป เดเตเดฎเตเดชเตเดธเตเดฑเตเดฑเต เดเต เดเดฒเตเดฒเตเดเตเดเดฟเตฝ เดเดเตฝเดเตเดเตเดเดฟ เดเดเตเดธเตเดเตเดฐเดพเดเตเดฑเตเดฑเต เดเดชเดฏเตเดเดฟเดเตเดเตเด.

๐งช เดฐเดพเดธเดฎเดพเตผเดเดเตเดเตพ:
- เดเตเดชเตเดชเตผ เดเดเตเดธเดฟเดเตเดฒเตเดฑเตเดกเต เดเดฒเตเดฒเตเดเตเดเดฟเตฝ เดฌเตเตผเดกเต เดฎเดฟเดถเตเดฐเดฟเดคเด เดชเตเดฒเตเดณเตเดณ เดเตเดชเตเดชเตผ เดเดเดฟเดธเตเดฅเดพเดจเดฎเดพเดเตเดเดฟเดฏ เดซเดเดเดฟเดธเตเดกเตเดเตพ เดเดชเดฏเตเดเดฟเดเตเดเตเด.
- เดฎเตเดเตเดฒเตเดฌเตเดฏเตเดเตเดเดพเดจเดฟเตฝ เดเดฒเตเดฒเตเดเตเดเดฟเตฝ เดเตเดฒเตเดฑเตเดคเดพเดฒเตเดฃเดฟเตฝ เดเดเดเตเดเดฟเดฏ เดธเดฟเดธเตเดฑเตเดฑเดฎเดฟเดเต เดซเดเดเดฟเดธเตเดกเตเดเตพ เดเดชเดฏเตเดเดฟเดเตเดเตเด (เดฒเตเดฌเตฝ เดจเดฟเตผเดฆเตเดฆเตเดถเดเตเดเตพ เดชเดพเดฒเดฟเดเตเดเตเด).
- เดเตผเดชเตเดชเด เดเดดเดฟเดตเดพเดเตเดเดพเตป เดฎเตเตฝเดตเตเดณเตเดณเด เดเดดเดฟเดเตเดเตเดจเตเดจเดคเต เดเดดเดฟเดตเดพเดเตเดเตเด.
- เดฐเดพเดธ เดเดฟเดเดฟเดคเตเดธเดฏเตเดเตเดเดฟเดเต เดเตเดฒเตเดธเตเด เดฎเดพเดธเตเดเตเด เดงเดฐเดฟเดเตเดเตเด.`
    },
    images: [
      "assets/rust.jpg",
      "assets/WhatsApp Image 2025-09-12 at 00.53.31_a9b5e5d9.jpg"
  ],imageTitles: {
    en: ["Kerala Affected Region", "Chance of Recovery"],
    hi: ["เคเฅเคฐเคฒ เคชเฅเคฐเคญเคพเคตเคฟเคค เคเฅเคทเฅเคคเฅเคฐ", "เคชเฅเคจเคฐเฅเคชเฅเคฐเคพเคชเฅเคคเคฟ เคเฅ เคธเคเคญเคพเคตเคจเคพ"],
    ml: ["เดเตเดฐเดณเด เดฌเดพเดงเดฟเดเตเด เดชเตเดฐเดฆเตเดถเด", "เดชเตเดจเดฐเดงเดฟเดตเดพเดธ เดธเดพเดงเตเดฏเดค"]
  }

  },

  "Class 4": {
    label: {
      en: "Whitefly Problem",
      hi: "เคถเฅเคตเฅเคค เคฎเคเฅเคเฅ เคธเคฎเคธเฅเคฏเคพ",
      ml: "เดตเตเดฑเตเดฑเตเดซเตเดฒเต เดชเตเดฐเดถเตเดจเด"
    },
    solution: {
      en: `๐ชด Organic Methods:
- Spray water to dislodge whiteflies.
- Clean leaves regularly to remove eggs.
- Introduce natural predators like ladybugs.
- Use neem oil or insecticidal soap weekly.

๐งช Non-Organic Methods:
- Apply chemical insecticides like imidacloprid or pyrethroids (use with caution).
- Use yellow sticky traps to monitor and reduce population.
- Avoid over-fertilizing, which attracts whiteflies.
- Rotate treatments to prevent resistance buildup.`,

      hi: `๐ชด เคเฅเคตเคฟเค เคตเคฟเคงเคฟเคฏเคพเค:
- เคธเคซเฅเคฆ เคฎเคเฅเคเคฟเคฏเฅเค เคเฅ เคนเคเคพเคจเฅ เคเฅ เคฒเคฟเค เคชเคพเคจเฅ เคเคฟเคกเคผเคเฅเคเฅค
- เคเคเคกเฅเค เคเฅ เคนเคเคพเคจเฅ เคเฅ เคฒเคฟเค เคชเคคเฅเคคเฅเค เคเฅ เคจเคฟเคฏเคฎเคฟเคค เคฐเฅเคช เคธเฅ เคธเคพเคซ เคเคฐเฅเคเฅค
- เคฒเฅเคกเฅเคฌเคเฅเคธ เคเฅเคธเฅ เคชเฅเคฐเคพเคเฅเคคเคฟเค เคถเคฟเคเคพเคฐเฅ เคเฅ เคเคเคฐเฅเคทเคฟเคค เคเคฐเฅเคเฅค
- เคจเฅเคฎ เคคเฅเคฒ เคฏเคพ เคเฅเคเคจเคพเคถเค เคธเคพเคฌเฅเคจ เคเคพ เคธเคพเคชเฅเคคเคพเคนเคฟเค เคเคชเคฏเฅเค เคเคฐเฅเคเฅค

๐งช เคฐเคพเคธเคพเคฏเคจเคฟเค เคตเคฟเคงเคฟเคฏเคพเค:
- เคเคฎเคฟเคกเคพเคเฅเคฒเฅเคชเฅเคฐเคฟเคก เคฏเคพ เคชเคพเคเคฐเฅเคฅเฅเคฐเฅเคเคก เคเฅเคธเฅ เคฐเคพเคธเคพเคฏเคจเคฟเค เคเฅเคเคจเคพเคถเคเฅเค เคเคพ เคชเฅเคฐเคฏเฅเค เคเคฐเฅเค (เคธเคพเคตเคงเคพเคจเฅ เคธเฅ เคเคชเคฏเฅเค เคเคฐเฅเค)เฅค
- เคชเฅเคฒเฅ เคธเฅเคเคฟเคเฅ เคเฅเคฐเฅเคช เคเคพ เคเคชเคฏเฅเค เคเคฐเฅเค เคคเคพเคเคฟ เคธเคเคเฅเคฏเคพ เคเคฎ เคนเฅเฅค
- เคเคงเคฟเค เคเคฐเฅเคตเคฐเค เคฆเฅเคจเฅ เคธเฅ เคฌเคเฅเค, เคเคฟเคธเคธเฅ เคธเคซเฅเคฆ เคฎเคเฅเคเคฟเคฏเคพเค เคเคเคฐเฅเคทเคฟเคค เคนเฅเคคเฅ เคนเฅเคเฅค
- เคชเฅเคฐเคคเคฟเคฐเฅเคง เคธเฅ เคฌเคเคจเฅ เคเฅ เคฒเคฟเค เคเคชเคเคพเคฐเฅเค เคเฅ เคฌเคฆเคฒเคคเฅ เคฐเคนเฅเคเฅค`,

      ml: `๐ชด เดเตผเดเดพเดจเดฟเดเต เดฎเดพเตผเดเดเตเดเตพ:
- เดตเตเดฑเตเดฑเตเดซเตเดฒเต เดจเตเดเตเดเดเดเตเดฏเตเดฏเดพเตป เดตเตเดณเตเดณเด เดธเตเดชเตเดฐเต เดเตเดฏเตเดฏเตเด.
- เดเดฒเดเตพ เดถเตเดเดฟเดฏเดพเดเตเดเดฟ เดฎเตเดเตเดเดเตพ เดจเตเดเตเดเดเดเตเดฏเตเดฏเตเด.
- เดฒเตเดกเดฟเดฌเดเตเดเตพ เดชเตเดฒเตเดณเตเดณ เดชเตเดฐเดเตเดคเดฟเดฆเดคเตเดค เดถเดคเตเดฐเตเดเตเดเดณเต เดเดเตผเดทเดฟเดเตเดเตเด.
- เดจเตเด เดเดฏเดฟเตฝ เดเดฒเตเดฒเตเดเตเดเดฟเตฝ เดเตปเดธเตเดเตเดเดฟเดธเตเดกเตฝ เดธเตเดชเตเดชเต เดเดดเตเดเดคเตเดฑเตเด เดเดชเดฏเตเดเดฟเดเตเดเตเด.

๐งช เดฐเดพเดธเดฎเดพเตผเดเดเตเดเตพ:
- เดเดฎเดฟเดกเดพเดเตเดฒเตเดชเตเดฐเดฟเดกเต เดเดฒเตเดฒเตเดเตเดเดฟเตฝ เดชเตเดฑเตเดคเตเดฐเตเดฏเดฟเดกเต เดชเตเดฒเตเดณเตเดณ เดฐเดพเดธ เดเตเดเดจเดพเดถเดฟเดจเดฟเดเตพ เดเดชเดฏเตเดเดฟเดเตเดเตเด (เดถเตเดฐเดฆเตเดงเดฏเตเดเต).
- เดตเตเดฑเตเดฑเตเดซเตเดฒเต เดจเดฟเดฐเตเดเตเดทเดฟเดเตเดเดพเตป เดฎเดเตเด เดธเตเดฑเตเดฑเดฟเดเตเดเดฟ เดเตเดฐเดพเดชเตเดชเตเดเตพ เดเดชเดฏเตเดเดฟเดเตเดเตเด.
- เดตเตเดฑเตเดฑเตเดซเตเดฒเต เดเดเตผเดทเดฟเดเตเดเดพเตป เดธเดพเดงเตเดฏเดคเดฏเตเดณเตเดณ เดเดงเดฟเด เดซเตผเดเตเดเดฟเดฒเตเดธเตผ เดเดดเดฟเดตเดพเดเตเดเตเด.
- เดชเตเดฐเดคเดฟเดฐเตเดงเด เดเดดเดฟเดตเดพเดเตเดเดพเตป เดเดฟเดเดฟเดคเตเดธเดเตพ เดฎเดพเดฑเดฟ เดฎเดพเดฑเดฟ เดเดชเดฏเตเดเดฟเดเตเดเตเด.`
    },
    images: [
      "assets/whitefly.jpg",
      "assets/WhatsApp Image 2025-09-12 at 00.53.31_be06626e.jpg"
  ],imageTitles: {
    en: ["Kerala Affected Region", "Chance of Recovery"],
    hi: ["เคเฅเคฐเคฒ เคชเฅเคฐเคญเคพเคตเคฟเคค เคเฅเคทเฅเคคเฅเคฐ", "เคชเฅเคจเคฐเฅเคชเฅเคฐเคพเคชเฅเคคเคฟ เคเฅ เคธเคเคญเคพเคตเคจเคพ"],
    ml: ["เดเตเดฐเดณเด เดฌเดพเดงเดฟเดเตเด เดชเตเดฐเดฆเตเดถเด", "เดชเตเดจเดฐเดงเดฟเดตเดพเดธ เดธเดพเดงเตเดฏเดค"]
  }

  }
};
   

    async function init() {
      const modelURL = MODEL_URL + "model.json";
      const metadataURL = MODEL_URL + "metadata.json";
      model = await tmImage.load(modelURL, metadataURL);
      maxPredictions = model.getTotalClasses();
      labelContainer = document.getElementById("label-container");
      document.getElementById("imageUpload").addEventListener("change", handleImageUpload);
      

    }

    async function handleImageUpload(event) {
      const file = event.target.files[0];
      if (!file) {
        const t = translationsDiagnosis[LANGUAGE];
        labelContainer.innerHTML = `<div><strong>โ ${t.noImage}</strong></div>`;
        return;
      }

      const img = document.createElement("img");
      img.src = URL.createObjectURL(file);
      img.onload = async () => {
        document.getElementById("image-preview").innerHTML = "";
        document.getElementById("image-preview").appendChild(img);
        document.getElementById("image-info").innerHTML =` ๐ท <strong>Image:</strong> ${file.name}`;
        await predict(img);
      };
    }

    async function predict(imageElement) {
      const prediction = await model.predict(imageElement);
      // Adjust probabilities: reduce by 0.1 if greater than 0.9
  const adjusted = prediction.map(p => {
    const adjustedProb = p.probability > 0.9 ? p.probability - 0.1 : p.probability;
    return { ...p, probability: adjustedProb };
  });


      const filtered = prediction.filter(p => p.probability >= CONFIDENCE_THRESHOLD);
      lastPrediction = filtered.length > 0 ? filtered : null;
      renderDiagnosis(lastPrediction);
    }

    function renderDiagnosis(predictions) {
      const t = translationsDiagnosis[LANGUAGE];
      labelContainer.innerHTML = "";

      if (!predictions || predictions.length === 0) {
        labelContainer.innerHTML = `<div><strong>๐ค ${t.unclear}</strong></div>` ;
        return;
      }

    predictions.forEach(p => {
        const advisory = advisoryMap[p.className];
        if (!advisory) return;

        const label = advisory.label?.[LANGUAGE] || advisory.label.en;
        const solution = advisory.solution?.[LANGUAGE] || advisory.solution.en;
        const titles = advisory.imageTitles?.[LANGUAGE] || advisory.imageTitles?.en || [];

        const block = document.createElement("div");
        block.innerHTML = `
          <strong>${t.confidence}:</strong> ${(p.probability * 100).toFixed(2)}%<br>
          <strong>${t.diagnosis}:</strong> ${label}<br>
          <strong>${t.solution}:</strong> ${solution.replace(/\n/g, "<br>")}
        `;

        advisory.images.forEach((url, index) => {
          const refImg = document.createElement("img");
          refImg.src = url;
          refImg.alt = titles[index] || "Reference Image";

          const caption = document.createElement("div");
          caption.innerText = titles[index] || "";

          block.appendChild(refImg);
          block.appendChild(caption);
        });

        labelContainer.appendChild(block);
      });
    }


     function updateDiagnosisLabels() {
      const t = translationsDiagnosis[LANGUAGE];
      document.getElementById("diagnosisTitle").innerText = t.title;
      document.getElementById("uploadLabel").childNodes[0].nodeValue = t.uploadLabel + " ";
      document.getElementById("footerText").innerText = t.footer;
    }

    document.getElementById("languageSelect").addEventListener("change", (e) => {
      LANGUAGE = e.target.value;
      updateDiagnosisLabels();
      renderDiagnosis(lastPrediction);
    });
     

    window.onload = () => {
      updateDiagnosisLabels();
      init();
    };
  </script>
</body>
</html>